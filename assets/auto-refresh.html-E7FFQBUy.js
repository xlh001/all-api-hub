import{_ as s,c as a,a as d,b as e,d as l,e as n,w as r,r as i,o as u}from"./app-MzNlMRU4.js";const f={};function m(h,t){const o=i("RouteLink");return u(),a("div",null,[t[20]||(t[20]=d('<h1 id="自动刷新与实时数据" tabindex="-1"><a class="header-anchor" href="#自动刷新与实时数据"><span>自动刷新与实时数据</span></a></h1><blockquote><p>让账号余额、用量、模型列表保持最新，无需每次手动点击“刷新”。同时提供后台定时器与弹窗打开时的即时刷新双重策略。</p></blockquote><h2 id="功能概览" tabindex="-1"><a class="header-anchor" href="#功能概览"><span>功能概览</span></a></h2><ul><li><strong>后台定时器</strong>：由 <code>autoRefreshService</code> 驱动，在浏览器后台定时调用账号刷新接口，支持 10 秒～数小时的自定义间隔。</li><li><strong>打开即刷新</strong>：可选的“打开插件时自动刷新”开关，适合关闭后台定时器但仍想保证数据同步的场景。</li><li><strong>最小间隔保护</strong>：独立设置 <code>minInterval</code> 防止过于频繁的手动刷新触发站点风控。</li><li><strong>即时刷新</strong>：随时执行“立即刷新”，立刻获取所有站点最新余额/额度。</li></ul><h2 id="前置条件" tabindex="-1"><a class="header-anchor" href="#前置条件"><span>前置条件</span></a></h2>',5)),e("ol",null,[t[3]||(t[3]=e("li",null,"至少已成功添加一个站点账号。",-1)),t[4]||(t[4]=e("li",null,"浏览器需保持扩展运行（移动端 Kiwi/Firefox 亦可，但需确保浏览器未被系统杀死）。",-1)),e("li",null,[t[1]||(t[1]=l("若站点存在 Cloudflare 防护，请先参考 ",-1)),n(o,{to:"/cloudflare-helper.html"},{default:r(()=>t[0]||(t[0]=[l("Cloudflare 过盾助手",-1)])),_:1,__:[0]}),t[2]||(t[2]=l(" 完成校验。",-1))])]),t[21]||(t[21]=d('<h2 id="设置入口" tabindex="-1"><a class="header-anchor" href="#设置入口"><span>设置入口</span></a></h2><ol><li>打开插件 → <strong>设置</strong>。</li><li>选择 <strong>“基础设置 → 自动刷新”</strong> 选项卡，进入 <code>RefreshSettings</code> 面板。</li></ol><h2 id="主要配置项" tabindex="-1"><a class="header-anchor" href="#主要配置项"><span>主要配置项</span></a></h2><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td><strong>启用自动刷新</strong></td><td>控制后台定时器的开关；关闭后仅保留手动刷新。</td></tr><tr><td><strong>刷新间隔（秒）</strong></td><td>定时器运行周期，对应 <code>accountAutoRefresh.interval</code>。输入 &lt;10 秒会被拦截提示。</td></tr><tr><td><strong>打开插件时自动刷新</strong></td><td>每次点击浏览器图标打开弹窗时自动执行一次 <code>refreshNow()</code>。</td></tr><tr><td><strong>最小刷新间隔（秒）</strong></td><td>限制用户频繁点击“刷新”按钮；默认 60 秒。</td></tr><tr><td><strong>恢复默认</strong></td><td>调用 <code>resetAutoRefreshConfig()</code>，恢复到 360s/60s/启用状态。</td></tr></tbody></table><h2 id="工作原理" tabindex="-1"><a class="header-anchor" href="#工作原理"><span>工作原理</span></a></h2><ol><li>用户保存设置后，通过 <code>UserPreferencesContext</code> 将 <code>accountAutoRefresh</code> 写入本地偏好。</li><li>背景页收到 <code>updateAutoRefreshSettings</code> 消息，调用 <code>autoRefreshService.setupAutoRefresh()</code>： <ul><li>若开关关闭或配置不完整则停止定时器。</li><li>否则根据间隔创建 <code>setInterval</code>，周期性执行 <code>accountStorage.refreshAllAccounts(false)</code>。</li></ul></li><li>刷新结果（成功/失败）会通过 <code>AUTO_REFRESH_UPDATE</code> 消息广播到前端，若弹窗未打开则静默忽略。</li></ol><h2 id="推荐策略" tabindex="-1"><a class="header-anchor" href="#推荐策略"><span>推荐策略</span></a></h2><ul><li><strong>高频检查</strong>：核心账号建议设置 300～600 秒，保证余额告警及时。</li><li><strong>低频 + 打开刷新</strong>：若担心站点限流，可将后台定时器关闭，仅保留“打开即刷新”。</li><li><strong>配合通知</strong>：结合浏览器自身通知或脚本，监听 <code>AUTO_REFRESH_UPDATE</code> 以二次开发提醒。</li></ul><h2 id="常见问题" tabindex="-1"><a class="header-anchor" href="#常见问题"><span>常见问题</span></a></h2>',9)),e("table",null,[t[15]||(t[15]=e("thead",null,[e("tr",null,[e("th",null,"问题"),e("th",null,"解决方案")])],-1)),e("tbody",null,[t[13]||(t[13]=e("tr",null,[e("td",null,"定时刷新未触发"),e("td",null,"可能是浏览器被系统休眠，重新打开扩展或手动点击“立即刷新”；必要时尝试降低间隔。")],-1)),e("tr",null,[t[8]||(t[8]=e("td",null,"频繁触发 Cloudflare 限流",-1)),e("td",null,[t[6]||(t[6]=l("适当增大刷新间隔，并确保 ",-1)),n(o,{to:"/cloudflare-helper.html"},{default:r(()=>t[5]||(t[5]=[l("Cloudflare 过盾助手",-1)])),_:1,__:[5]}),t[7]||(t[7]=l(" 能正常弹窗校验。",-1))])]),t[14]||(t[14]=e("tr",null,[e("td",null,"刷新失败且提示 401/403"),e("td",null,"登录状态已失效，重新在浏览器访问对应站点并刷新插件。")],-1)),e("tr",null,[t[12]||(t[12]=e("td",null,"多设备冲突",-1)),e("td",null,[t[10]||(t[10]=l("建议配合 ",-1)),n(o,{to:"/webdav-sync.html"},{default:r(()=>t[9]||(t[9]=[l("WebDAV 备份与自动同步",-1)])),_:1,__:[9]}),t[11]||(t[11]=l(" 统一账号数据，避免重复刷新同一站点。",-1))])])])]),t[22]||(t[22]=e("h2",{id:"相关文档",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#相关文档"},[e("span",null,"相关文档")])],-1)),e("ul",null,[e("li",null,[n(o,{to:"/cloudflare-helper.html"},{default:r(()=>t[16]||(t[16]=[l("Cloudflare 过盾助手",-1)])),_:1,__:[16]})]),e("li",null,[n(o,{to:"/auto-checkin.html"},{default:r(()=>t[17]||(t[17]=[l("自动签到",-1)])),_:1,__:[17]})]),e("li",null,[n(o,{to:"/webdav-sync.html"},{default:r(()=>t[18]||(t[18]=[l("WebDAV 备份与自动同步",-1)])),_:1,__:[18]})]),e("li",null,[n(o,{to:"/permissions.html"},{default:r(()=>t[19]||(t[19]=[l("权限管理（可选权限）",-1)])),_:1,__:[19]})])])])}const p=s(f,[["render",m]]),b=JSON.parse('{"path":"/auto-refresh.html","title":"自动刷新与实时数据","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1764959691000,"contributors":[{"name":"anime","username":"anime","email":"street-anime-olive@duck.com","commits":2,"url":"https://github.com/anime"}],"changelog":[{"hash":"15ec417762ab3685b2de9a0a9b90db727f1fa9b5","time":1764959691000,"email":"street-anime-olive@duck.com","author":"anime","message":"docs: add new sections for CLIProxyAPI integration, model redirect, sorting priority, and permissions management"},{"hash":"354ae115450f46ad1fd5e8d31c5667282ea9cf81","time":1763876710000,"email":"street-anime-olive@duck.com","author":"anime","message":"docs: update README and add comprehensive feature documentation"}]},"filePathRelative":"auto-refresh.md"}');export{p as comp,b as data};
