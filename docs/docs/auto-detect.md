# 自动识别排查指南

本页用于排查在插件「新增/编辑账号」中点击 **自动识别** 时出现的：识别耗时过长、无限等待、识别失败（401/403/格式错误等），以及无法提交等问题。

## 识别耗时过长（一直在“识别中...”）

自动识别需要打开临时页面并读取站点信息，遇到以下情况会明显变慢：

- **站点启用了 Cloudflare / 防火墙验证**：请留意是否弹出了临时窗口；如果需要人工点选验证，请在超时前完成验证。
- **网络/站点响应慢**：建议稍等片刻，或切换网络/代理后重试。
- **权限/浏览器异常**：如果你刚授予了可选权限后开始出现“一直等待”，见下方“授予可选权限后无限等待”。

### 授予可选权限后无限等待

在初次授予可选权限后识别部分站点可能一直在自动识别，表现为界面一直加载：

- 解决方式：打开浏览器扩展管理页，先 **禁用再启用** 本扩展，或 **重启浏览器** 后重试识别/授权。
- 可选权限的用途与说明见：`/permissions`（权限管理）。

## 识别失败：先确认真的已登录

自动识别依赖你在同一浏览器中已经登录目标站点：

1. 先在浏览器打开目标站点后台（控制台）页面。
2. 确认没有被重定向回登录页（刷新页面验证一次）。
3. 再回到插件执行自动识别。

## 识别失败：尝试切换认证方式

不同站点/魔改版本对接口与登录态处理不同，识别失败时优先尝试切换认证方式：

- **访问令牌认证失败**：切换到 **Cookie 认证** 后再次自动识别。
- **AnyRouter**：必须使用 **Cookie 认证**，并且 Cookie 必须来自当前已登录的账号；Cookie 认证不支持同站点多账号同时使用。


## 无法提交 / 无法保存：逐项检查必填项

当必填项未满足时，提交按钮会被禁用或保存失败。请逐项确认：

- 已填写 **站点名称**、**用户名**、**用户 ID**
- **充值金额比例（汇率）** 为大于 0 的数字
- 选择 **访问令牌认证** 时：已填写 **访问令牌**
- 选择 **Cookie 认证** 时：已导入或填写 **会话 Cookie（Header 值）**

如果自动识别始终无法完成，可切换到 **手动添加**，先保存账号，再逐步补齐信息。

