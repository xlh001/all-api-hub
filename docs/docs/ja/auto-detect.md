# 自動認識トラブルシューティングガイド

本ページは、プラグインの「アカウントの新規追加/編集」で **自動認識** をクリックした際に発生する、認識に時間がかかりすぎる、無限待機、認識失敗（401/403/形式エラーなど）、および送信不可といった問題の調査に使用します。

## 認識に時間がかかりすぎる（ずっと「認識中...」のまま）

自動認識は一時的なページを開き、サイト情報を読み取る必要があります。以下の場合、処理が著しく遅くなります：

- **サイトで Cloudflare / ファイアウォール認証が有効になっている場合**：一時的なウィンドウがポップアップ表示されていないか注意してください。手動で認証を選択する必要がある場合は、タイムアウトする前に認証を完了してください。
- **ネットワーク/サイトの応答が遅い場合**：しばらく待つか、ネットワーク/プロキシを切り替えてから再試行することをお勧めします。
- **権限/ブラウザの異常**：オプションの権限を付与した直後から「ずっと待機中」になる場合は、下記の「オプションの権限を付与した後の無限待機」を参照してください。

### オプションの権限を付与した後の無限待機

オプションの権限を初めて付与した後、一部のサイトの認識が自動認識のまま停止し、インターフェースがロードし続けることがあります：

- 解決方法：ブラウザの拡張機能管理ページを開き、本拡張機能を一度 **無効にしてから再度有効にする** か、または **ブラウザを再起動** してから認識/認証を再試行してください。
- オプションの権限の用途と説明については、`/permissions`（権限管理）を参照してください。

## 認識失敗：まず本当にログイン済みか確認してください

自動認識は、ユーザーが同じブラウザで対象サイトにすでにログインしていることに依存します：

1. まずブラウザで対象サイトの管理画面（コンソール）ページを開きます。
2. ログインページにリダイレクトされていないことを確認します（ページを一度更新して検証してください）。
3. その後、プラグインに戻り自動認識を実行します。

## 認識失敗：認証方式の切り替えを試してください

サイトやカスタマイズされたバージョンによって、インターフェースやログイン状態の処理が異なるため、認識に失敗した場合は、まず認証方式の切り替えを試してください：

- **アクセストークン認証失敗**：**Cookie認証** に切り替えてから再度自動認識を実行してください。
- **AnyRouter**：**Cookie認証** を使用する必要があります。また、Cookie は現在ログインしているアカウントのものである必要があります。Cookie認証は、同一サイトでの複数アカウントの同時使用をサポートしていません。

## 送信不可 / 保存不可：必須項目を一つずつ確認してください

必須項目が満たされていない場合、送信ボタンが無効になるか、保存に失敗します。以下の項目を一つずつ確認してください：

- **サイト名**、**ユーザー名**、**ユーザーID** が入力されていること
- **チャージ金額比率（為替レート）** が 0 より大きい数字であること
- **アクセストークン認証** を選択した場合：**アクセストークン** が入力されていること
- **Cookie認証** を選択した場合：**セッションCookie（Header値）** がインポートまたは入力されていること

自動認識がどうしても完了しない場合は、**手動追加** に切り替えて、まずアカウントを保存し、その後情報を段階的に補完することができます。