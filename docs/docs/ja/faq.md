# よくある質問

プラグインの使用中に遭遇する一般的な問題をまとめました。

## 🔐 認証方式について

### CookieモードとAccess Token方式の違いは何ですか？

プラグインは2種類の認証方式をサポートしています。

| 認証方式        | 特徴                                | 適用シーン               | 推奨度     |
|-------------|-----------------------------------|----------------------|----------|
| **Access Token** | ✅ 複数アカウントをサポート<br>✅ 永続的に有効で、期限切れなし<br>✅ より安全で安定 | ほとんどの標準的な中継サイト     | ⭐⭐⭐⭐⭐ 強く推奨 |
| **Cookie**  | ⚠️ シングルアカウント<br>⚠️ 期限切れの可能性あり<br>✅ 互換性が高い      | トークンが制限された特殊なサイト<br>改造サイト | ⭐⭐⭐ 特殊な場合に使用 |

**Access Token 方式の使用を推奨します**。ただし、以下の場合は除きます。
- サイトがアクセストークンをサポートしていない場合
- 改造版の中継サイトを使用している場合
- トークン機能が無効になっている場合

### 認証方式を切り替えるにはどうすればよいですか？

アカウント追加時、アカウントダイアログで対応する認証方式を選択します。
1. 「アカウント新規追加」をクリック
2. サイトアドレスを入力
3. 「認証方式」ドロップダウンメニューから `Access Token` または `Cookie` を選択
4. 「自動識別」をクリック

## 🔧 特殊なサイトに関する問題

<a id="anyrouter-error"></a>
### AnyRouterサイトでエラーが発生した場合、どうすればよいですか？

AnyRouter は改造版の中継サイトであり、標準の Access Token 方式をサポートしていません。

**解決策**：
1. アカウント追加時、**Cookie モード**を選択してください。
2. まずブラウザで AnyRouter サイトにログインします。
3. その後、プラグインの自動識別機能を使用してアカウントを追加します。

::: warning 注意
AnyRouter はAPIに変更を加えているため、一部の機能が正常に動作しない可能性があります。問題が発生した場合は、サイト管理者にご連絡ください。
:::

### 自動識別が失敗した場合、どうすればよいですか？

自動識別が失敗した場合は、以下の方法を試してください。

1.  **認証方式の切り替え**：Access Token から Cookie モードへの切り替えを試してください。
2.  **手動追加**：自動識別失敗後、以下の情報を手動で入力してください。
    -   ユーザー名
    -   ユーザーID
    -   アクセストークン
    -   チャージ比率
3.  **ログイン状態の確認**：目的のサイトにブラウザでログインしていることを確認してください。
4.  **サイトの互換性確認**：サイトがサポート対象のプロジェクト（下記参照）に基づいているか確認してください。

### どのサイトが互換性がない可能性がありますか？

サイトが大幅な二次開発を行い、重要なインターフェース（例：`/api/user`）を変更した場合、プラグインが正常に動作しない可能性があります。

一般的な非互換性の状況：
- ユーザー情報APIが変更されている
- アクセストークン機能が無効になっている
- 認証方式がカスタムされている
- API応答形式が変更されている

## 🐛 機能とバグ関連

### 機能の問題やバグに遭遇した場合、どうすればよいですか？

1.  **Issueの検索**：[GitHub Issues](https://github.com/qixing-jk/all-api-hub/issues) にアクセスし、同様の問題がないか検索してください。
2.  **最新バージョンの使用**：
    -   ストア版は更新が遅いため、GitHub Release 版の使用をお勧めします。
    -   または、main ブランチの開発バージョンを直接使用してください。

### 最新バージョンを入手するにはどうすればよいですか？

プラグインは複数のプラットフォームで公開されており、更新速度に差異があります。

| プラットフォーム             | 更新速度          | バージョンの取得 |
|-------------------------|---------------|-------------|
| **GitHub Releases**     | ⚡ 最速          | [ダウンロードはこちら](https://github.com/qixing-jk/all-api-hub/releases) |
| **Chrome Web Store**    | 🐌 遅め（3-5日審査） | [インストールはこちら](https://chromewebstore.google.com/detail/lapnciffpekdengooeolaienkeoilfeo) |
| **Edge Add-ons**        | 🐌 遅め（3-5日審査） | [インストールはこちら](https://microsoftedge.microsoft.com/addons/detail/pcokpjaffghgipcgjhapgdpeddlhblaa) |
| **Firefox Add-ons**     | ⚡ 速い（数時間審査）   | [インストールはこちら](https://addons.mozilla.org/firefox/addon/{bc73541a-133d-4b50-b261-36ea20df0d24}) |

::: tip ヒント
修正済みのバグに遭遇した場合は、GitHub Releases から最新バージョンをダウンロードして手動でインストールすることをお勧めします。
:::

## ⚙️ 機能の使用に関する問題

### WebDAVバックアップを使用するにはどうすればよいですか？

WebDAV バックアップは、複数のデバイス間でデータを同期するのに役立ちます。

1.  **WebDAVの設定**：
    -   「設定」→「WebDAV バックアップ」を開きます。
    -   WebDAVサーバーアドレス（完全なURL）を入力します。
    -   ユーザー名とパスワードを入力します。

2.  **同期ポリシーの選択**：
    -   `統合`（推奨）：ローカルとリモートのデータをインテリジェントに統合します。
    -   `アップロードのみ`：ローカルデータのみをサーバーにアップロードします。
    -   `ダウンロードのみ`：サーバーからデータのみをダウンロードします。

3.  **自動同期の有効化**：
    -   「自動同期を有効にする」にチェックを入れます。
    -   同期間隔（デフォルト3600秒/1時間）を設定します。

::: tip 推奨サービス
-   [堅果雲](https://www.jianguoyun.com/)（中国国内からのアクセスが高速）
-   Nextcloud（セルフホスティング）
-   Synology NAS（群暉）
:::

### CherryStudio / New API へエクスポートするにはどうすればよいですか？

クイックエクスポート機能を使用すると、サイト設定をワンクリックで他のプラットフォームにインポートできます。

**設定手順**：

1.  **New API の場合**：
    -   「設定」→「基本設定」を開きます。
    -   New API サーバーアドレスを設定します。
    -   管理者トークン（Admin Token）を入力します。
    -   ユーザーIDを入力します。

2.  **CherryStudio の場合**：
    -   追加の設定は不要です。
    -   CherryStudio が実行中であることを確認してください。

**エクスポート手順**：

1.  「キー管理」ページに移動します。
2.  エクスポートしたいサイトを見つけます。
3.  操作メニューをクリックします。
4.  「CherryStudio へエクスポート」または「New API へエクスポート」を選択します。

::: info スマート検出
New API へのエクスポート時、プラグインは同じチャネルが既に存在するかどうかを自動的に検出し、重複追加を避けます。
:::

より完全なエクスポートと統合の説明については、[クイックサイト設定エクスポート](./quick-export.md) を参照してください。CLIProxyAPI 管理インターフェースとの連携を希望する場合は、[CLIProxyAPI 統合](./cliproxyapi-integration.md) を参照してください。

### サイトのチェックイン機能を使用するにはどうすればよいですか？

一部の中継サイトは、毎日のチェックインで報酬を獲得することをサポートしています。

1.  **チェックイン検出の有効化**：
    -   アカウントを編集します。
    -   「チェックイン検出を有効にする」にチェックを入れます。

2.  **カスタムチェックインURL**（オプション）：
    -   サイトのチェックインページが標準パスではない場合
    -   「カスタムチェックインURL」を入力できます。
    -   「カスタムチャージURL」（オプション）を入力します。

3.  **チェックインの実行**：
    -   チェックインが必要なアカウントにはチェックインアイコンが表示されます。
    -   アカウントカード上のチェックインボタンをクリックします。
    -   チェックインページが自動的に開きます。

### アカウントの並べ替えをカスタマイズするにはどうすればよいですか？

プラグインは複数の並べ替え方法の優先順位設定をサポートしています。

1.  **並べ替え設定に入る**：
    -   「設定」→「並べ替え優先度設定」を開きます。

2.  **優先順位の調整**：
    -   並べ替え条件をドラッグして優先順位を調整します。
    -   条件をチェック/アンチェックして有効/無効を切り替えます。

3.  **利用可能な並べ替え条件**：
    -   📌 現在のサイトを最上位に固定
    -   🏥 健康状態での並べ替え（エラー > 警告 > 不明 > 正常）
    -   ✅ チェックインが必要なアカウントを最上位に固定
    -   🔗 カスタムチェックインURLを持つアカウントを最上位に固定
    -   📊 ユーザーカスタムフィールドでの並べ替え（残高/消費/名前）

各並べ替えルールの詳細な意味と設定例については、[並べ替え優先度設定](./sorting-priority.md) を参照してください。

### 自動更新はどのように設定しますか？

自動更新により、アカウントデータを最新の状態に保つことができます。

1.  **自動更新の有効化**：
    -   「設定」→「自動更新」を開きます。
    -   「定期的な自動更新を有効にする」にチェックを入れます。

2.  **更新間隔の設定**：
    -   デフォルト：360秒（6分）
    -   最小：60秒（1分）
    -   サイト数に応じて調整してください。

3.  **その他のオプション**：
    -   ✅ プラグインを開いたときに自動更新
    -   ✅ 健康状態を表示

::: warning 注意
更新間隔が短すぎると、頻繁なリクエストが発生する可能性があります。60秒以上に設定することをお勧めします。
:::

## 📱 モバイルでの使用

### 携帯電話で使用するにはどうすればよいですか？

プラグインはモバイルデバイスでの使用をサポートしています。

**Android デバイス**：
1.  [Kiwi Browser](https://play.google.com/store/apps/details?id=com.kiwibrowser.browser) をインストール（推奨）
    -   Chrome拡張機能と完全に互換性があります。
    -   すべての機能をサポートしています。

2.  または Firefox for Android をインストール
    -   Firefox Add-ons からインストールします。

**iOS デバイス**：
-   現在非対応（iOSの制限）

### モバイル利用の推奨事項

1.  **サイドバーモードを使用する**：携帯電話の画面により適しています。
2.  **自動更新を有効にする**：頻繁な手動更新を避けます。
3.  **WebDAV同期を設定する**：PCと携帯電話の間でデータを同期します。

## 🔒 データセキュリティ

### データはどこに保存されますか？

-   **ローカルストレージ**：すべてのデータはブラウザのローカルストレージに保存されます。
-   **完全オフライン**：プラグインのコア機能はネットワーク接続を必要としません。
-   **データはアップロードされません**：いかなる第三者サーバーにもデータはアップロードされません。

### データは失われますか？

定期的にデータをバックアップすることをお勧めします。

1.  **JSONエクスポート**：
    -   「設定」→「データとバックアップ」に移動します。
    -   「データのエクスポート」をクリックします。
    -   JSONファイルを保存します。

2.  **WebDAV同期**（推奨）：
    -   自動的にクラウドにバックアップされます。
    -   複数のデバイスでの同期をサポートします。

## 🆘 その他の問題

### サイト重複検出とは何ですか？

サイトを追加する際、プラグインは同じサイトが既に存在するかどうかを自動的に検出します。
- サイトURLに基づいて判断します。
- 既に存在する場合、プロンプトが表示され、迅速な変更が許可されます。
- 同じサイトの重複追加を避けます。

### 健康状態とはどういう意味ですか？

健康状態はアカウントの利用可能性を示します。

| 状態     | アイコン   | 意味                     |
|--------|--------|------------------------|
| 🟢 正常  | Healthy | アカウントが正常に動作しています |
| 🟡 警告  | Warning | 残高不足または注意が必要です   |
| 🔴 エラー | Error  | API呼び出し失敗またはアカウント異常 |
| ⚪ 不明  | Unknown | まだ検出されていないか、状態を取得できません |

### プラグインはトラフィックを消費しますか？

- アカウントデータを更新するときにのみサイトAPIにアクセスします。
- リクエスト量は非常に少ないです（各サイトあたり約数KB）。
- 自動更新はWi-Fi環境での使用をお勧めします。

### コードを貢献するにはどうすればよいですか？

プルリクエストの提出を歓迎します。
1.  プロジェクトリポジトリをフォークします。
2.  機能ブランチを作成します。
3.  コードをコミットします。
4.  プルリクエストを送信します。

詳細は [CONTRIBUTING.md](https://github.com/qixing-jk/all-api-hub/blob/main/CONTRIBUTING.md) を参照してください。

---

## 📚 関連ドキュメント

-   [利用ガイド](./get-started.md)
-   [GitHub リポジトリ](https://github.com/qixing-jk/all-api-hub)
-   [問題のフィードバック](https://github.com/qixing-jk/all-api-hub/issues)
-   [更新履歴](https://github.com/qixing-jk/all-api-hub/blob/main/CHANGELOG.md)

::: tip 答えが見つかりませんか？
上記のコンテンツで問題が解決しない場合は、[GitHub Issues](https://github.com/qixing-jk/all-api-hub/issues) にて質問してください。
:::
